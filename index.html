<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfica Interactiva: Eje Cardíaco</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .ecg-path {
            stroke-width: 2;
            fill: none;
        }
        .highlight-zone {
            opacity: 0.3;
        }
        .btn-active {
            transform: scale(1.05);
            box-shadow: 0 0 0 3px #1d4ed8;
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-5xl mx-auto text-center">
        <h1 class="text-2xl md:text-4xl font-bold text-gray-800 mb-2">Calculadora Visual del Eje Cardíaco</h1>
        <p class="text-gray-600 mb-8">Selecciona un escenario para visualizar el resultado basado en el método de DI, DII y aVF.</p>

        <div id="controls" class="flex flex-wrap justify-center gap-3 mb-8">
            <button onclick="updateAxis('normal')" id="btn-normal" class="px-6 py-3 bg-white text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition-all duration-300 btn-active">
                Normal
            </button>
            <button onclick="updateAxis('izquierda')" id="btn-izquierda" class="px-6 py-3 bg-white text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition-all duration-300">
                Izquierda
            </button>
            <button onclick="updateAxis('derecha')" id="btn-derecha" class="px-6 py-3 bg-white text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition-all duration-300">
                Derecha
            </button>
            <button onclick="updateAxis('extremo')" id="btn-extremo" class="px-6 py-3 bg-white text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition-all duration-300">
                Extremo
            </button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start">
            <!-- Columna del Círculo Hexaxial -->
            <div class="card p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">Visualización del Eje</h2>
                <svg id="cabrera-circle" viewBox="0 0 200 200" class="w-full h-auto max-w-sm mx-auto">
                    <!-- Zonas de color corregidas -->
                    <path id="zone-normal" d="M 100 100 L 186.6 50 A 100 100 0 0 1 100 200 L 100 100 Z" fill="#a3e635" class="highlight-zone"/>
                    <path id="zone-izquierda" d="M 100 100 L 100 0 A 100 100 0 0 1 186.6 50 L 100 100 Z" fill="#facc15" class="highlight-zone" style="display:none;"/>
                    <path id="zone-derecha" d="M 100 100 L 100 200 A 100 100 0 0 1 0 100 L 100 100 Z" fill="#60a5fa" class="highlight-zone" style="display:none;"/>
                    <path id="zone-extremo" d="M 100 100 L 0 100 A 100 100 0 0 1 100 0 L 100 100 Z" fill="#a1a1aa" class="highlight-zone" style="display:none;"/>

                    <!-- Ejes de referencia estáticos -->
                    <line x1="0" y1="100" x2="200" y2="100" stroke="#d1d5db" stroke-width="1"/><text x="190" y="95" font-size="8" fill="#6b7280">DI</text>
                    <line x1="100" y1="0" x2="100" y2="200" stroke="#d1d5db" stroke-width="1"/><text x="105" y="12" font-size="8" fill="#6b7280">aVF</text>
                    <line x1="50" y1="13.4" x2="150" y2="186.6" stroke="#d1d5db" stroke-width="1"/><text x="150" y="190" font-size="8" fill="#6b7280">DII</text>
                    <line x1="150" y1="13.4" x2="50" y2="186.6" stroke="#d1d5db" stroke-width="1"/><text x="45" y="190" font-size="8" fill="#6b7280">DIII</text>
                    <line x1="13.4" y1="50" x2="186.6" y2="150" stroke="#d1d5db" stroke-width="1"/><text x="10" y="55" font-size="8" fill="#6b7280">aVR</text>
                    <line x1="186.6" y1="50" x2="13.4" y2="150" stroke="#d1d5db" stroke-width="1"/><text x="180" y="55" font-size="8" fill="#6b7280">aVL</text>
                    
                    <!-- Vector del Eje -->
                    <line id="axis-vector" x1="100" y1="100" stroke="#ef4444" stroke-width="3.5" stroke-linecap="round" marker-end="url(#arrowhead)"/>
                    <defs><marker id="arrowhead" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#ef4444"></path></marker></defs>
                </svg>
            </div>

            <!-- Columna de Derivaciones -->
            <div class="card p-6 flex flex-col justify-center text-left">
                <div class="flex justify-center items-center gap-2 mb-4">
                    <h2 id="axis-title" class="text-2xl font-bold text-lime-600 text-center">Eje Normal</h2>
                    <button id="speak-button" class="p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.858 5.858a3 3 0 014.242 0L12 7.758l1.9-1.9a3 3 0 014.242 0 3 3 0 010 4.242L12 16.242l-5.9-5.9a3 3 0 010-4.242z" transform="translate(-1 -1) scale(1.2)"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M12 18a3 3 0 01-3-3V9a3 3 0 016 0v6a3 3 0 01-3 3z"/>
                        </svg>
                    </button>
                </div>
                <p id="axis-description" class="text-gray-600 mb-6 text-center">El eje se encuentra entre -30° y +90°.</p>
                
                <div class="space-y-4">
                    <!-- Derivación 1 -->
                    <div class="flex items-center gap-4">
                        <span class="font-bold text-lg text-gray-700 w-12" id="lead1-label">DI</span>
                        <div class="w-full bg-gray-100 rounded-lg p-2">
                             <svg viewBox="0 0 100 40" class="w-full h-auto">
                                <path id="ecg1" class="ecg-path"/>
                            </svg>
                        </div>
                        <span id="lead1-status" class="font-semibold"></span>
                    </div>
                    <!-- Derivación 2 -->
                    <div class="flex items-center gap-4">
                        <span class="font-bold text-lg text-gray-700 w-12" id="lead2-label">DII</span>
                        <div class="w-full bg-gray-100 rounded-lg p-2">
                             <svg viewBox="0 0 100 40" class="w-full h-auto">
                                <path id="ecg2" class="ecg-path"/>
                            </svg>
                        </div>
                        <span id="lead2-status" class="font-semibold"></span>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-12 text-center text-sm text-gray-500">
            <p>Dr. Javier A. Rodríguez. MD, MSc.</p>
            <p>Agosto 10 de 2025</p>
        </footer>
    </div>

    <script>
        const ecgPaths = {
            positive: 'M 0 20 L 20 20 L 25 25 L 35 5 L 45 20 L 100 20', // qR
            negative: 'M 0 20 L 20 20 L 25 15 L 35 35 L 45 20 L 100 20'  // rS
        };

        const axisData = {
            normal: {
                title: 'Eje Normal',
                audioDescription: 'Eje Normal. El vector se encuentra entre menos treinta y más noventa grados, con D I y D II positivos.',
                description: 'El eje se encuentra entre -30° y +90°.',
                color: 'lime',
                angle: 30,
                lead1: { label: 'DI', status: 'Positivo (qR)', ecg: 'positive' },
                lead2: { label: 'DII', status: 'Positivo (qR)', ecg: 'positive' }
            },
            izquierda: {
                title: 'Desviación Izquierda',
                audioDescription: 'Desviación a la Izquierda. El vector es más negativo que menos treinta grados, con D I positivo y D II negativo.',
                description: 'El eje es más negativo que -30°.',
                color: 'yellow',
                angle: -60,
                lead1: { label: 'DI', status: 'Positivo (qR)', ecg: 'positive' },
                lead2: { label: 'DII', status: 'Negativo (rS)', ecg: 'negative' }
            },
            derecha: {
                title: 'Desviación Derecha',
                audioDescription: 'Desviación a la Derecha. El vector es más positivo que más noventa grados, con D I negativo y aVF positivo.',
                description: 'El eje es más positivo que +90°.',
                color: 'blue',
                angle: 120,
                lead1: { label: 'DI', status: 'Negativo (rS)', ecg: 'negative' },
                lead2: { label: 'aVF', status: 'Positivo (qR)', ecg: 'positive' }
            },
            extremo: {
                title: 'Eje Extremo (Noroeste)',
                audioDescription: 'Eje Extremo o Noroeste. El vector se encuentra en el cuadrante superior izquierdo, con D I y aVF negativos.',
                description: 'El eje se encuentra entre -90° y +/-180°.',
                color: 'gray',
                angle: -135,
                lead1: { label: 'DI', status: 'Negativo (rS)', ecg: 'negative' },
                lead2: { label: 'aVF', status: 'Negativo (rS)', ecg: 'negative' }
            }
        };
        
        const colorMap = {
            lime: { text: 'text-lime-600', stroke: 'stroke-lime-600', fill: 'fill-lime-400' },
            yellow: { text: 'text-yellow-600', stroke: 'stroke-yellow-600', fill: 'fill-yellow-400' },
            blue: { text: 'text-blue-600', stroke: 'stroke-blue-600', fill: 'fill-blue-400' },
            gray: { text: 'text-gray-600', stroke: 'stroke-gray-600', fill: 'fill-gray-400' }
        };

        function getLineCoords(angle) {
            const angleRad = angle * Math.PI / 180;
            const r = 90;
            return {
                x1: 100 - r * Math.cos(angleRad), y1: 100 - r * Math.sin(angleRad),
                x2: 100 + r * Math.cos(angleRad), y2: 100 + r * Math.sin(angleRad)
            };
        }

        function speak(text) {
            speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'es-ES';
            speechSynthesis.speak(utterance);
        }

        function updateAxis(axisType) {
            const data = axisData[axisType];
            
            document.getElementById('axis-title').textContent = data.title;
            document.getElementById('axis-description').textContent = data.description;
            document.getElementById('lead1-label').textContent = data.lead1.label;
            document.getElementById('lead2-label').textContent = data.lead2.label;
            document.getElementById('lead1-status').textContent = data.lead1.status;
            document.getElementById('lead2-status').textContent = data.lead2.status;
            
            document.getElementById('ecg1').setAttribute('d', ecgPaths[data.lead1.ecg]);
            document.getElementById('ecg2').setAttribute('d', ecgPaths[data.lead2.ecg]);

            const colors = colorMap[data.color];
            const allColorClasses = Object.values(colorMap).flatMap(c => Object.values(c));
            
            const elementsToColor = [
                document.getElementById('axis-title'),
                document.getElementById('lead1-status'),
                document.getElementById('lead2-status'),
                document.getElementById('ecg1'),
                document.getElementById('ecg2')
            ];

            elementsToColor.forEach(el => {
                const classList = el.classList;
                allColorClasses.forEach(c => classList.remove(c));
                classList.add(colors.text, colors.stroke);
            });

            document.querySelectorAll('#cabrera-circle .highlight-zone').forEach(zone => zone.style.display = 'none');
            document.getElementById(`zone-${axisType}`).style.display = 'block';

            const vectorEndCoords = getLineCoords(data.angle);
            const axisVector = document.getElementById('axis-vector');
            axisVector.setAttribute('x1', 100);
            axisVector.setAttribute('y1', 100);
            axisVector.setAttribute('x2', vectorEndCoords.x2);
            axisVector.setAttribute('y2', vectorEndCoords.y2);

            document.querySelectorAll('#controls button').forEach(btn => {
                btn.classList.remove('btn-active', 'bg-blue-600', 'text-white');
            });
            const activeButton = document.getElementById(`btn-${axisType}`);
            activeButton.classList.add('btn-active', 'bg-blue-600', 'text-white');

            const speakButton = document.getElementById('speak-button');
            speakButton.onclick = () => speak(data.audioDescription);
        }

        // Estado inicial
        window.onload = () => {
            updateAxis('normal');
        };
    </script>
</body>
</html>
